// SPDX-License-Identifier: GPL-3.0
pragma solidity 0.8.27;

/**
 * @dev IAuthValidator. Interface for verification of auth data.
 */
interface IAuthValidator {
    /**
     * @dev AuthResponseField. Information about response fields from verification. Used in verify function.
     * @param name Name of the response field
     * @param value Value of the response field
     */
    struct AuthResponseField {
        string name;
        uint256 value;
    }

    /**
     * @dev Get version of the contract
     */
    function version() external view returns (string memory);

    /**
     * @dev Verify the proof with the supported method informed in the auth query data
     * packed as bytes and that the proof was generated by the sender.
     * @param sender Sender of the proof.
     * @param proof Proof packed as bytes to verify.
     * @param authMethodParams Auth method parameters for the verification.
     * @param responseMetadata Additional metadata from the response for the verification.
     * @return userID User Id for the auth proof verified and response fields.
     * @return authResponseFields Additional response fields.
     */
    function verify(
        address sender,
        bytes calldata proof,
        bytes calldata authMethodParams,
        bytes calldata responseMetadata
    ) external returns (uint256 userID, AuthResponseField[] memory authResponseFields);
}
